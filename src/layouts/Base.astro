---
import globalCss from '../styles/global.css?inline';
import { listCompetitions } from "../lib/queries";
const { title = "お笑い主要データまとめ", description = "M-1/KOC/R-1 決勝結果まとめ" } = Astro.props;
const siteTitle = "お笑い主要データまとめ";
const base = import.meta.env.BASE_URL;
const comps = listCompetitions(); // [{key,name,sort_order}, ...]
const canonical = new URL(Astro.url.pathname, Astro.site).href;
---
<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <link rel="icon" href="/favicon.ico" />
		<link rel="canonical" href={canonical} />
    <meta name="format-detection" content="telephone=no" />
    <!-- 共有時のOGP（必要なら調整） -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />
    <meta name="theme-color" content="#111111" />
		<style is:global set:html={globalCss}></style>
		{import.meta.env.PROD && (
			<>
				<!-- Google tag (gtag.js) -->
				<script async src="https://www.googletagmanager.com/gtag/js?id=G-9Y0DD8R00V"></script>
				<script is:inline>
					window.dataLayer = window.dataLayer || [];
					function gtag(){dataLayer.push(arguments);}
					gtag('js', new Date());

					gtag('config', 'G-9Y0DD8R00V');
				</script>
			</>
		)}
  </head>
  <body>
    <a class="skip" href="#main">本文へスキップ</a>
    <header class="site-header">
      <div class="container header-row">
        <a class="brand" href={base}>{siteTitle}</a>
        <nav class="nav">
          <details class="menu">
            <summary>大会</summary>
            <ul class="menu-list">
              {comps.map(c => (
                <li><a href={`${base}${c.key}`}>{c.name}</a></li>
              ))}
            </ul>
          </details>
          <a href={`${base}co`}>芸人一覧</a>
        </nav>
      </div>
    </header>
		<script is:inline>
			// クリックで外側なら閉じる
			document.addEventListener('click', (ev) => {
				// 複数将来対応：開いてる details を全部閉じる
				document.querySelectorAll('details.menu[open]').forEach((el) => {
					if (!el.contains(ev.target)) el.open = false;
				});
			});

			// Esc でも閉じる（フォーカスがどこでもOK）
			document.addEventListener('keydown', (ev) => {
				if (ev.key === 'Escape') {
					document.querySelectorAll('details.menu[open]').forEach((el) => (el.open = false));
				}
			});
		</script>

    <main id="main" class="container content">
      <slot />
    </main>

    <footer class="site-footer">
      <div class="container">
        <p class="muted">
					本サイトは非公式のデータ集です。<br />
					データは公式発表等の一次情報を優先しつつ、公開された二次情報も参照して編成しています。収集には手作業も含まれるため、正確性・完全性は保証できません。鵜呑みにせず一次情報でのご確認を推奨します。誤りにお気づきの際は、ご指摘いただけると嬉しいです。
				</p>
        <p class="muted">
					<a href="https://forms.gle/ewpxezQFHYeHDzmD9" target="_blank">お問い合わせフォーム</a><br />
					作成者: <a href="https://twitter.com/gmm_tea_ob" target="_blank">てあ</a>
				</p>
      </div>
    </footer>
  </body>
</html>
